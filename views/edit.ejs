<html>
<head>
    <!-- META TAGS -->
    <meta charset="UTF-8" />
    <meta name="Zoomable" content="yes" />
    <!-- Viewport mobile tag for sensible mobile support -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <!-- META TAGS END -->

    <base href="/" />
    <title>Zoomable</title>

    <!--STYLES-->
    <link rel="stylesheet" href="/styles/angular-material.css">
    <link rel="stylesheet" href="/styles/importer.css">
    <!--STYLES END-->

    <!--SCRIPTS-->
    <script src="/js/dependencies/sails.io.js"></script>
    <script src="/js/dependencies/angular.js"></script>
    <script src="/js/dependencies/angular-ui-router.js"></script>
    <script src="/js/dependencies/angular-material.js"></script>
    <script src="/js/dependencies/angular-messages.js"></script>
    <script src="/js/dependencies/angular-animate.js"></script>
    <script src="/js/dependencies/angular-aria.js"></script>
    <script src="/js/dependencies/clipboard.js"></script>
    <script src="/js/dependencies/ngclipboard.js"></script>
    <script src="/js/public/zoomableApp.js"></script>
    <script src="/js/public/directives.js"></script>
    <script src="/js/public/controllers/dashboardController.js"></script>
    <script src="/js/public/controllers/loginController.js"></script>
    <script src="/js/public/controllers/editController.js"></script>
    <script src="/js/public/servicesAPI.js"></script>
    <!--SCRIPTS END-->

    <!--Added this so the client has access to the csrf tag and it's grabbed first service side on every page -->
    <script type="text/javascript">
    window.SAILS_LOCALS = {
        _csrf: '<%= _csrf %>',
        me: <%- JSON.stringify(me) %>,
        video: <%- JSON.stringify(video) %>
    };
    </script>
</head>

<body ng-app="zoomableApp">
    <!-- show navbar view -->
    <div ng-controller="loginController">
        <!-- Navbar shows only when user is logged in -->

        <md-toolbar id="navbar">
            <div layout="row" layout-align="space-between">
                <!-- First Group: Menu & Home Button -->
                <span layout layout-align="none center">
                    <md-button class="md-icon-button" aria-label="Menu">
                        <md-icon md-svg-src="images/ic_menu_white_24px.svg"></md-icon>
                    </md-button>
                    <md-button ng-href="/" class="home-btn" aria-label="Logo" md-no-ink></md-button>
                </span>

                <!-- Second Group: Search Area -->
                <span class="search-container">
                    <md-input-container md-no-float class="md-block">
                        <input type="text" placeholder="Search"></input>
                    </md-input-container>
                    <md-button class="md-icon-button search-btn" aria-label="Search" md-no-ink>
                        <md-icon md-svg-src="images/ic_search_white_24px.svg"></md-icon>
                    </md-button>
                </span>

                <!-- Third Group: Upload & Profile Button -->
                <span layout="row" layout-align="space-between center">
                    <md-menu md-position-mode="target-right target" >
                        <md-button aria-label="Open demo menu" class="md-flat" ng-click="$mdOpenMenu($event)"><%= me.username %>
                            <md-icon md-menu-origin md-svg-src="images/ic_arrow_drop_down_white_24px.svg"></md-icon>
                        </md-button>
                        <md-menu-content width="3">
                            <md-menu-item>
                                <md-button ng-click="">
                                    <div layout="row">
                                        <p flex>Settings</p>
                                    </div>
                                </md-button>
                            </md-menu-item>
                            <md-menu-item>
                                <md-button class="dropdown-link">
                                    <div layout="row">
                                        <a href="/api/user/logout" flex>Log Out</a>
                                    </div>
                                </md-button>
                            </md-menu-item>
                        </md-menu-content>
                    </md-menu>
                </span>

            </div>
        </md-toolbar>
    </div>


    <!-- show dashboard view -->
    <div ng-controller="editController" ng-cloak id="edit" ng-init="init()">
        <md-content layout-padding>

            <!-- EDIT PAGE HEADER -->
            <h2 class="page-header">
                <md-icon class="header-icon"></md-icon>
                <span class="md-headline header-title">{{ originalVideoTitle }}</span>
            </h2>

            <!-- EDIT PAGE CONTENT -->
            <md-card>
                <md-tabs md-dynamic-height md-border-bottom>
                    <!-- TAB 1 : SETTINGS & INFO-->
                    <md-tab>
                        <md-tab-label>
                            <md-icon class="tab-icon" md-svg-icon="images/ic_edit_black_24px.svg"></md-icon>
                            <span class="tab-header">INFO & SETTINGS</span>
                        </md-tab-label>
                        <md-tab-body>
                            <md-content class="md-padding">
                                <div layout="row"> <!-- start top row -->
                                    <div flex="60">
                                        <!-- TODO: Uncomment after server side can auto generate image directory
                                        <span ng-show="video.thumbnailDir">
                                        <img class="small-video-player" ng-src="{{ video.thumbnail }}" alt="{{ originalVideoTitle }}" />
                                    </span> -->
                                    <img ng-src="{{ defaultImagePath }}" alt="{{ originalVideoTitle }}" />
                                </div>
                                <div flex="40">
                                    <div layout="column">
                                        <div flex>
                                            <div layout="row" layout-align="end start">
                                                <md-button class="md-raised cancel-btn" ng-click="showConfirm($event)">Cancel</md-button>
                                                <md-button class="md-raised md-primary save-btn" ng-click="saveChanges()" ng-disabled="videoForm.$pristine || !videoForm.$valid">Save</md-button>
                                            </div>
                                        </div>
                                        <div id="toast-area"></div>
                                        <div flex layout-margin class="video-info">
                                            <p class="title">Video Information</p>
                                            <p>
                                                <span class="field">Time Uploaded:</span>
                                                <span class="value">{{ video.createdAt | date:'MMMM d, y h:mma' }}</span>
                                            </p>
                                            <p>
                                                <span class="field">Video Duration:</span>
                                                <span class="value">{{ video.duration }}</span>
                                            </p>
                                            <p class="embed-link-area">
                                                <span class="field">Embed Link:</span>
                                                <input id="embedURL" value="{{ video.videoDir }}" readonly="readonly"/>
                                                <md-button class="md-icon-button" aria-label="Copy" md-ink-ripple="false" md-no-ink ngclipboard data-clipboard-target="#embedURL" ng-click="copyEmbedLink(video.videoDir)">
                                                    <md-icon class="copy-btn" md-svg-icon="images/ic_insert_link_black_24px.svg"></md-icon>
                                                    <md-tooltip md-direction="bottom">Copy</md-tooltip>
                                                </md-button>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>  <!-- end top row -->
                            <div> <!-- start editable fields -->
                                <form name="videoForm" class="form-padding">
                                    <md-input-container class="md-block">
                                        <label>Title</label>
                                        <input required name="videoTitle" ng-model="video.title" />
                                        <div ng-messages="videoForm.videoTitle.$error">
                                            <div ng-message="required">This is required.</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container class="md-block">
                                        <label>Description</label>
                                        <input name="videoDescription" ng-model="video.description" />
                                    </md-input-container>
                                    <div layout="row">
                                        <div flex="80" class="input-chips">
                                            <md-chips ng-model="tags" readonly="false" placeholder="+Tag" delete-button-label="Remove Tag" secondary-placeholder="Add a tag">
                                            </div>
                                            <div flex="20">
                                                <div class="custom-button-set">
                                                    <div layout="column">
                                                        <div flex>
                                                            <label>Privacy</label>
                                                        </div>
                                                        <div flex class="privacy-buttons">
                                                            <div layout="row" class="custom-switch">
                                                                <div flex="50" class="custom-btn" ng-class="video.privacy ? 'selected' : ''" ng-click="updatePrivacy(1)">
                                                                    <span class="text">Public</span>
                                                                </div>
                                                                <div flex="50" class="custom-btn" ng-class="video.privacy ? '' : 'selected'" ng-click="updatePrivacy(0)">
                                                                    <span class="text">Private</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div> <!-- end editable fields -->
                            </md-content>
                        </md-tab-body>
                    </md-tab>

                    <!-- TAB 2 : SUBTITLES & CC (NOT DONE)-->
                    <md-tab>
                        <md-tab-label>
                            <md-icon class="tab-icon" md-svg-icon="images/ic_subtitles_black_24px.svg"></md-icon>
                            <span class="tab-header">SUBTITLES & CC</span>
                        </md-tab-label>
                        <md-tab-body>
                            <md-content class="md-padding">
                                <h1 class="md-display-2">Subtitles Here</h1>
                                <p>TO BE IMPLEMENTED.</p>
                            </md-content>
                        </md-tab-body>
                    </md-tab>

                    <!-- TAB 3 : STATISTICS (NOT DONE)-->
                    <md-tab>
                        <md-tab-label>
                            <md-icon class="tab-icon" md-svg-icon="images/ic_trending_up_black_24px.svg"></md-icon>
                            <span class="tab-header">STATISTICS</span>
                        </md-tab-label>
                        <md-tab-body>
                            <md-content class="md-padding">
                                <h1 class="md-display-2">Statistics Here</h1>
                                <p>TO BE IMPLEMENTED.</p>
                            </md-content>
                        </md-tab-body>
                    </md-tab>

                </md-tabs>
            </md-card>

        </md-content>
    </div>

</body>
</html>
